<script setup lang="ts">
    import carouse1 from "@/assets/assets/img/hero-carousel/1.jpg"
    import carouse2 from "@/assets/assets/img/hero-carousel/2.jpg"
    import carouse3 from "@/assets/assets/img/hero-carousel/3.jpg"
    import { watch, ref, onMounted, nextTick } from "vue";
    import api from "@/services/apiService";


    const listOfGallery = ref([]);
    const listOfFiles = ref([]);
    onMounted(async () => {
      try {
        // Fetch the list of galleries
        const responseGallery = await api.get("/Gallery");
        listOfGallery.value = responseGallery.data;
        console.log(listOfGallery.value);

        } catch (error) {
          console.error(error);
        }
    });

    watch(
      () => listOfGallery,

      async (value) => {
        if (value.length > 0) {
          listOfFiles.value = await Promise.all(listOfGallery.value.map(async(item:any) => {
            const domain = 'https://localhost:7243/';
            const imageResponse = await api.get(`Files/${item.galleryId}`);
            const imagePath = imageResponse.data[0];
              return {
                ...item,
                heroImage: domain+imageResponse+'/Files'+imagePath.fileName,
              };
          }));
          console.log(listOfFiles.value);
        }
      },
      { immediate: true }
    );
</script>
<template>
    <!-- ======= hero Section ======= -->
  <section id="hero">
    <div class="hero-container">
      <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000"> 

        <ol id="hero-carousel-indicators" class="carousel-indicators"></ol>

        <div class="carousel-inner" role="listbox">

          <div class="carousel-item active"  v-for="item in listOfFiles" :key="item.galleryId">
            <img :src="item.heroImage" alt="">
            <div class="carousel-container">
              <div class="container">
                <h2 class="animate__animated animate__fadeInDown">The Best Business Information </h2>
                <p class="animate__animated animate__fadeInUp">We're In The Business Of Helping You Start Your Business</p>
                <a href="#about" class="btn-get-started scrollto animate__animated animate__fadeInUp">Get Started</a>
              </div>
            </div>
          </div>

          <!-- <div class="carousel-item" :style="{ 'background-image': `url(${carouse2})` }">
            <div class="carousel-container">
              <div class="container">
                <h2 class="animate__animated animate__fadeInDown">At vero eos et accusamus</h2>
                <p class="animate__animated animate__fadeInUp">Helping Business Security & Peace of Mind for Your Family</p>
                <a href="#about" class="btn-get-started scrollto animate__animated animate__fadeInUp">Get Started</a>
              </div>
            </div>
          </div>

          <div class="carousel-item" :style="{ 'background-image': `url(${carouse3})` }">
            <div class="carousel-container">
              <div class="container">
                <h2 class="animate__animated animate__fadeInDown">Temporibus autem quibusdam</h2>
                <p class="animate__animated animate__fadeInUp">Beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem</p>
                <a href="#about" class="btn-get-started scrollto animate__animated animate__fadeInUp">Get Started</a>
              </div>
            </div>
          </div>
 -->
        </div>

        <a class="carousel-control-prev" href="#heroCarousel" role="button" data-bs-slide="prev">
          <span class="carousel-control-prev-icon bi bi-chevron-left" aria-hidden="true"></span>
        </a>

        <a class="carousel-control-next" href="#heroCarousel" role="button" data-bs-slide="next">
          <span class="carousel-control-next-icon bi bi-chevron-right" aria-hidden="true"></span>
        </a>

      </div>
    </div>
  </section><!-- End Hero Section -->
</template>